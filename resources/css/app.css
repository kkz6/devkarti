@import "./fonts.css";
@import "tailwindcss";
@import "./typography.css";

@theme {
  /* Font families */
  --font-sans: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
  --font-mono: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;

  /* Breakpoints */
  --breakpoint-sm: 640px;

  /* Custom colors */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-accent: var(--accent);
  --color-muted: var(--muted);
  --color-border: var(--border);
}

@custom-variant dark (&:where([data-theme=dark], [data-theme=dark] *));

:root,
html[data-theme="light"] {
  --background: #fdfdfd;
  --foreground: #282728;
  --accent: #006cac;
  --muted: #e6e6e6;
  --border: #ece9e9;
}

html[data-theme="dark"] {
  --background: #212737;
  --foreground: #eaedf3;
  --accent: #ff6b01;
  --muted: #343f60bf;
  --border: #ab4b08;
}

@layer base {
  *, *::before, *::after {
    box-sizing: border-box;
  }

  * {
    @apply border-border outline-accent/75;
    scrollbar-width: auto;
    scrollbar-color: var(--color-muted) transparent;
  }

  html {
    @apply scroll-smooth;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    @apply bg-background font-mono text-foreground selection:bg-accent/75 selection:text-background;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    /* font-family: 'IBM Plex Sans', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important; */
  }

  #app {
    display: contents; /* This makes #app transparent to layout */
  }

  /* Remove default margins */
  footer {
    margin: 0;
  }

  hr {
    margin: 0;
    border: 0;
    border-top: 1px solid var(--border);
  }

  /* Prevent overflow */
  * {
    max-width: 100%;
  }

  a,
  button {
    @apply outline-offset-1 outline-accent focus-visible:no-underline focus-visible:outline-2 focus-visible:outline-dashed;
  }
  button:not(:disabled),
  [role="button"]:not(:disabled) {
    cursor: pointer;
  }
}

@utility max-w-app {
  @apply max-w-3xl;
}

.active-nav {
  @apply underline decoration-wavy decoration-2 underline-offset-4;
}

/* Source: https://piccalil.li/blog/a-more-modern-css-reset/ */
/* Anything that has been anchored to should have extra scroll margin */
:target {
  scroll-margin-block: 1rem;
}

#hero {
    @apply pb-6 pt-8;
  }

  #hero h1 {
    @apply my-4 inline-block text-3xl font-bold sm:my-8 sm:text-5xl;
  }

  #hero .rss-link {
    @apply mb-6;
  }

  #hero .rss-icon {
    @apply mb-2 h-6 w-6 scale-110 sm:mb-3 sm:scale-125;
    fill: rgb(var(--color-accent));
  }

  #hero p {
    @apply my-2;
  }

  .social-wrapper {
    @apply mt-4 flex flex-col sm:flex-row sm:items-center;
  }

  .social-links {
    @apply mb-1 mr-2 whitespace-nowrap sm:mb-0;
  }

  /* Fix social links positioning */
  #hero {
    @apply relative z-20;
  }

  /* Ensure featured section doesn't overlap */
  #featured {
    @apply relative z-10;
  }

  /* ===== Featured & Recent Posts Sections ===== */
  #featured,
  #recent-posts {
    @apply pb-6 pt-12;
  }

  #featured h2,
  #recent-posts h2 {
    @apply text-2xl font-semibold tracking-wide;
  }

  .all-posts-btn-wrapper {
    @apply my-8 text-center;
  }

  /* Page title section */
  main > section:first-child h1 {
    @apply mb-4;
  }

/* Page Transition Animations - AstroPaper Style */
@layer utilities {
  /* Prevent layout shift during transitions */
  .page-transitioning {
    overflow-x: hidden;
    position: relative;
  }

  /* Title animation clone */
  .title-animation-clone {
    transform-origin: left top;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    font-weight: bold;
    max-width: 90vw; /* Prevent overflow */
  }

  /* Title animating state - scales up and moves to top with limits */
  .title-animating {
    transform: scale(min(1.5, 2.5rem / 1rem)) translateY(max(-50vh, -200px));
    opacity: 0.8;
    font-size: clamp(1.5rem, 4vw, 2.5rem); /* Limit maximum size */
  }

  /* Content fade out - everything except the animating title, header, footer, and pagination */
  .content-fade-out main > section > *:not(.title-animation-clone),
  .content-fade-out #hero,
  .content-fade-out #featured,
  .content-fade-out #recent-posts {
    opacity: 0;
    transition: opacity 0.3s ease-out;
  }

  /* Keep header, footer, and pagination visible during transitions */
  .content-fade-out header,
  .content-fade-out footer,
  .content-fade-out nav[aria-label="Pagination"] {
    opacity: 1 !important;
  }

  /* Content fade in for new page - only main content */
  .content-fade-in main > section {
    animation: contentFadeIn 0.4s ease-out;
  }

  /* Ensure header and footer never animate */
  header, footer, nav[aria-label="Pagination"] {
    opacity: 1 !important;
    transform: none !important;
    transition: none !important;
  }

  @keyframes contentFadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Smooth scroll behavior */
  html {
    scroll-behavior: smooth;
  }

  /* Hide scrollbar during animation */
  .page-transitioning::-webkit-scrollbar {
    display: none;
  }

  .page-transitioning {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
}

/* Enhanced link hover effects */
@layer components {
  /* Blog post link container */
  .post-link {
    @apply block transition-transform duration-200 hover:translate-x-1;
  }

  /* Title hover effect */
  .post-title {
    @apply inline-block transition-all duration-200;
  }

  .post-link:hover .post-title {
    @apply text-accent/80;
  }
}

/* Temporary debug styles - remove after fixing */
.debug * {
  outline: 1px solid red;
}

/* Debug styles to identify layout issues */
.debug-layout * {
  outline: 1px solid red !important;
}

.debug-layout header {
  background: rgba(255, 0, 0, 0.1) !important;
}

.debug-layout main {
  background: rgba(0, 255, 0, 0.1) !important;
}

.debug-layout footer {
  background: rgba(0, 0, 255, 0.1) !important;
}

.debug-layout .mt-auto {
  background: rgba(255, 255, 0, 0.1) !important;
}

/* Debug: Show measurements */
.debug-layout::before {
  content: "Window: " attr(data-height);
  position: fixed;
  top: 10px;
  right: 10px;
  background: yellow;
  padding: 5px;
  z-index: 9999;
  font-size: 12px;
}

/* Ensure proper height calculation */
.h-screen {
  height: 100vh;
  height: 100dvh; /* Use dynamic viewport height if supported */
}

/* Remove default margins */
footer {
  margin: 0;
}
